# 分布式文件系统

分配计算任务时，让处理数据的代码离数据越近越好，分布式计算尽量减少数据的流动，而让程序流动。分布式文件系统与分布式计算相结合

## HDFS

hadoop 是用于分布式计算的生态系统

yarn：资源调度

mapreduce：分布式计算

spark：更复杂的分布式计算

**hdfs 框架**

- Master：NameNode 服务器 （维护目录树，名字空间）

  - 维护一个关键的数据结构（两张表）

    - 表1：路径名    块号列表bid

      > hdfs 给每个数据库一个唯一的 id 号

    - 表2：bid，    ip

- Slave：DataNode 服务器 （存放实体数据）

hdfs 把大文件分块，默认按照 128MB 大小分块

当客户端要读数据时，客户端向 NameNode 服务器发出请求，NameNode 计算出所读数据位于哪个数据块中，将数据块编号和ip返回给客户端，客户端直接向存放数据的主机请求数据

写入数据时，客户端只负责向其中一个 DataNode 写入数据，由这个 DataNode 以流水线的方式向其他 DataNode 写入数据

NameNode 在空闲时扫描数据块表，维护文件块列表的完整性

NameNode 的作用

- 维护两张表 （文件系统元数据）（文件元数据是保存在内存里的）
- 扫描 DataNode 服务器（上线下线）（数据节点管理），判断服务器状态和数据完整性（多拷贝维护）
- 负载均衡

